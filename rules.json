{
    "rules": [
        {
            "name": "Set venue filter type",
            "filter": ["any", ["==", ["get", "entityType"], "Venue"], ["==", ["get", "entityType"], "Brandhouse"]],
            "update": {
                "filterType": "filter-venue"
            }
        },
        {
            "name": "Set route filter type",
            "filter": ["==", ["get", "entityType"], "Route"],
            "update": {
                "filterType": "filter-route"
            }
        },
        {
            "name": "Set exhibitor filter type",
            "filter": ["==", ["get", "entityType"], "Exhibitor"],
            "update": {
                "filterType": "filter-exhibitor"
            }
        },
        {
            "name": "Set parents",
            "update": [
                {
                    "parents": [
                        "create-array",
                        ["get", "venueType"],
                        ["get", "sector"],
                        ["get", "parent1"],
                        ["get", "parent2"],
                        ["get", "filterType"]
                    ]
                },
                { "parent1": ["undefined"], "parent2": ["undefined"], "filterType": ["undefined"] }
            ]
        },
        {
            "name": "Rename iconURL to iconUrl",
            "update": [{ "iconUrl": ["get", "iconURL"] }, { "iconURL": ["undefined"] }]
        },
        {
            "name": "Rename logoURL to logoUrl",
            "update": [{ "logoUrl": ["get", "logoURL"] }, { "logoURL": ["undefined"] }]
        },
        {
            "name": "Set icons from venueType/sector",
            "filter": ["all", ["!", ["get", "iconUrl"]], ["get", "venueType"], ["get", "sector"]],
            "update": [
                {
                    "iconUrlBase": [
                        "concat",
                        "https://fest-digitalx.expofp.com/images/new/",
                        ["get", "venueType"],
                        "-",
                        ["get", "sector"]
                    ]
                },
                {
                    "iconUrlActive": ["concat", ["get", "iconUrlBase"], "-active.png"],
                    "iconUrl": ["concat", ["get", "iconUrlBase"], ".png"]
                },
                {
                    "iconUrlBase": ["undefined"]
                }
            ]
        },
        {
            "name": "Set default iconUrl for all entities",
            "filter": ["!", ["get", "iconUrl"]],
            "update": {
                "iconUrl": "https://fest-digitalx.expofp.com/images/icon-23.png"
            }
        },
        {
            "name": "Set name from id",
            "filter": ["!", ["get", "name"]],
            "update": { "name": ["get", "id"] }
        },
        {
            "name": "Set entityName",
            "filter": ["!", ["get", "entityName"]],
            "update": { "entityName": ["get", "name"] }
        },
        {
            "name": "Set buttons",
            "update": {
                "showMoreDetailsButton": true,
                "showDirectionsButton": true
            }
        },
        {
            "name": "Remove entities that are marked as not added to mapbox",
            "filter": ["==", ["get", "addedToMapbox"], "FALSE"],
            "delete": true
        },
        {
            "name": "Create venue filter",
            "create": {
                "id": "filter-venue",
                "name": "Venues",
                "iconClass": "venue"
            }
        },
        {
            "name": "Create route filter",
            "create": {
                "id": "filter-route",
                "name": "Routes",
                "iconClass": "route"
            }
        },
        {
            "name": "Create exhibitor filter",
            "create": {
                "id": "filter-exhibitor",
                "name": "Exhibitors",
                "iconClass": "exhibitor"
            }
        }
    ]
}
